<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<link rel="icon" type="image/png" href="assets/img/favicon.ico">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />

<title>Inventory</title>

<meta
	content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0'
	name='viewport' />
<meta name="viewport" content="width=device-width" />


<!-- Bootstrap core CSS     -->
<link href="assets/css/bootstrap.min.css" rel="stylesheet" />

<!-- Animation library for notifications   -->
<link href="assets/css/animate.min.css" rel="stylesheet" />

<!--  Light Bootstrap Table core CSS    -->
<link href="assets/css/light-bootstrap-dashboard.css" rel="stylesheet" />


<!--  CSS for Demo Purpose, don't include it in your project     -->
<link href="assets/css/demo.css" rel="stylesheet" />


<!--     Fonts and icons     -->
<link
	href="http://maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css"
	rel="stylesheet">
<link href='http://fonts.googleapis.com/css?family=Roboto:400,700,300'
	rel='stylesheet' type='text/css'>
<link href="assets/css/pe-icon-7-stroke.css" rel="stylesheet" />
<link href="assets/css/fusion.css" rel="stylesheet" />

</head>
<body>

	<div class="wrapper">
		<div class="sidebar" data-color="purple"
			>

			<!--   you can change the color of the sidebar using: data-color="blue | azure | green | orange | red | purple" -->


			<div class="sidebar-wrapper">
				<div class="logo">
					<a href="http://www.creative-tim.com" class="simple-text">
						Mobigents@Inventrory </a>
				</div>

				<ul class="nav">
					
					<li><a href="category.html"> <i
							class="pe-7s-more"></i>
							<p>Category</p>
					</a>
					</li>
					<li><a href="products.html"> <i class="pe-7s-keypad"></i>
							<p>Products</p>
					</a></li>
					
					<li><a href="sites.html"> <i class="pe-7s-box2"></i>
							<p>Sites</p>
					</a></li>

					<li class="active"><a href="addtostock.html"> <i class="fa fa-bars"></i>
							<p>Add To Stock</p>
					</a></li>

					<li ><a href="consumestock.html"> <i class="fa fa-bars"></i>
							<p>Withdraw From Stock</p>
					</a></li>
					
					<li><a href="history.html"> <i class="fa fa-bars"></i>
							<p>History</p>
					</a>
					</li>
					
				</ul>
			</div>
		</div>

		<div class="main-panel">
			<nav class="navbar navbar-default navbar-fixed">
				<div class="container-fluid">
					<div class="navbar-header">

						<a class="navbar-brand" href="#">Stock Management</a>
					</div>
					<div class="collapse navbar-collapse"></div>
				</div>
			</nav>


			<div class="content">
				<div class="container-fluid">
					<div class="card">
						<div class="header">
							<h4 class="title">Add to Stock</h4>
							<p class="category">Add items to stock.
							</p>

						</div>
						<div class="content">
							<div class="container-fluid">
								<div class="row">
									<div class="col-md-7">
										<div class="card">
											
											<div class="content">
												<form>
												<div class="row">
														<div class="col-md-12	">
															<div class="form-group">
																<label>Products</label> <select id="products"
																	class="form-control"  placeholder="Product"
																	>
																	<option selected disabled="disabled">Select A Product</option>
																	</select>
															</div>
														</div>
													</div>
													<div class="row dataFrom">
														
														<div class="col-md-4">
															<div class="form-group">
																<label>Stock Count</label> <input type="text" id="stockCount"
																	class="form-control" disabled="" placeholder="Stock Count"
																	value="0">
															</div>
														</div>
														<div class="col-md-4">
															<div class="form-group">
																<label>Unit Price</label> <input type="text" id="unitPrice"
																	class="form-control" disabled="" placeholder="Unit Price"
																	value="0">
															</div>
														</div>
														<div class="col-md-4">
															<div class="form-group">
																<label>Products</label> <select id="sites"
																	class="form-control"  placeholder="Sites"
																	>
																	<option selected disabled="disabled">Select A Site</option>
																	</select>
															</div>
														</div>
														
														
													</div>

													<div class="row dataFrom">
														<div class="col-md-6">
															<div class="form-group">
																<label>Add Stock Count</label> <input type="number" id="newCount"
																	class="form-control" placeholder="Add Stock Count" value="0">
															</div>
														</div>
														
														<div class="col-md-6">
															<div class="form-group">
																<label>Purchased By(User Name)</label> <input type="text" id="updatedFor"
																	class="form-control" placeholder="Transacted User" value="Guest">
															</div>
														</div>
													</div>

													

													<div class="row dataFrom">
														<div class="col-md-12">
															<div class="form-group">
																<label>Description</label>
																<textarea rows="5" class="form-control"
																	placeholder="Here can be your description" value="Mike">
																	</textarea>
															</div>
														</div>
													</div>

													<button type="button" id="save"
														class="btn btn-info btn-fill pull-right dataFrom">Save</button>
													<div class="clearfix"></div>
												</form>
											</div>
										</div>
									</div>
									<div class="col-md-5">
										<div class="card card-user">
											<div class="content">
												<div class="author" style="margin-top:0px">
													<a href="#"> <img style="width:100%;margin:5px" class=" border-gray"
														src="assets/images/lean-inventory.jpg" alt="...">

														<h4 class="title">
															Worlds most simple inventory management Software<br> <small></small>
														</h4>
													</a>
												</div>
												<p class="description text-center">
													
												</p>
											</div>
											<hr>
											<div class="text-center">
												<button href="#" class="btn btn-simple">
													<i class="fa fa-facebook-square"></i>
												</button>
												<button href="#" class="btn btn-simple">
													<i class="fa fa-twitter"></i>
												</button>
												<button href="#" class="btn btn-simple">
													<i class="fa fa-google-plus-square"></i>
												</button>

											</div>
										</div>
									</div>

								</div>
							</div>

						</div>
					</div>
				</div>
			</div>


			<footer class="footer">
				<div class="container-fluid">
					<nav class="pull-left">
						<ul>
							<li><a href="#"> Twitter </a></li>
							<li><a href="#"> Facebook </a></li>
							<li><a href="#"> Google </a></li>
						</ul>
					</nav>
					<p class="copyright pull-right">
						&copy; 2018 <a href="http://mobigents.com">Mobigents</a>,
						Intelligent Cloud Store
					</p>
				</div>
			</footer>

		</div>
	</div>


</body>

<!--   Core JS Files   -->
<script src="assets/js/jquery-1.10.2.js" type="text/javascript"></script>
<script src="assets/js/bootstrap.min.js" type="text/javascript"></script>

<!--  Checkbox, Radio & Switch Plugins -->
<script src="assets/js/bootstrap-checkbox-radio-switch.js"></script>

<!--  Charts Plugin -->
<script src="assets/js/chartist.min.js"></script>

<!--  Notifications Plugin    -->
<script src="assets/js/bootstrap-notify.js"></script>

<!--  Google Maps Plugin    -->
<script type="text/javascript"
	src="https://maps.googleapis.com/maps/api/js?sensor=false"></script>

<!-- Light Bootstrap Table Core javascript and methods for Demo purpose -->
<script src="assets/js/light-bootstrap-dashboard.js"></script>

<!-- Light Bootstrap Table DEMO methods, don't include it in your project! -->
<script src="assets/js/demo.js"></script>

<script src="microutils.js"></script>

<script type="text/javascript">
var serverRoot=getParameterByName("server");//"http://localhost:8081";
if(!serverRoot){
	serverRoot="http://ec2-35-169-132-136.compute-1.amazonaws.com:8081";
}
var server = serverRoot+"/mobigents-core";
var infoMap  =[];
var currentSelectedItem=null;
$(document).ready(function(){
	$(".dataFrom").css("display","none");
	$.getJSON(serverRoot+"/mobigents-rest/objects/products",function(data){
		   rows = data.rows;
		   for(var k in rows){	
			   infoMap[rows[k].data.name]=rows[k];
			   $("#products").append('<option value="'+rows[k].data.name+'">'+rows[k].data.name+'</option>');
		   }
	});
	
	getCombo("sites","#sites");
	
	$("#products").change(function(val){
		$(".dataFrom").css("display","block");
		currentSelectedItem=$(this).val();
		var data = infoMap[currentSelectedItem].data;
		$("#unitPrice").val(data.unitPrice);
		$("#stockCount").val(data.stockCount);
	});
	
	$("#save").click(function(){
		if(!currentSelectedItem){
			alert("Select a product Item");
		}else{
			var item = infoMap[currentSelectedItem];
			item.data.stockCount=parseInt(item.data.stockCount)+parseInt($("#newCount").val());
			
			executeJsonOnServer("PUT",serverRoot+"/mobigents-rest/objects/products/"+item.dataKey,"application/json",JSON.stringify(item.data),
	        		function(data){
				        var description=parseInt($("#newCount").val())+" "+item.data.name+" added to Stock";
						addToHistory("Add to Stock",description);
						rows = data.rows;
						$("#stockCount").val(rows[0].data.stockCount);
	    	        	alert("Successfully updated Item");
	        		},
	        		function(){
	        			//makeButtonEnable(selector);
	        		}
	    	);
		}
		
	});
	
});


function getCombo(domainName,selector){
	var rows =[];
	$.getJSON(serverRoot+"/mobigents-rest/objects/"+domainName,function(data){
		   rows = data.rows;
		   for(var k in rows){	
			   $(selector).append('<option value="'+rows[k].data.name+'">'+rows[k].data.name+'</option>');
		   }
	});
}



function addToHistory(operation,description){
	var history={user:"Admin",timeStamp:new Date().toUTCString(),operation:operation,description:description,site:$("#sites").val(),updatedFor:$("#updatedFor").val()};
	executeJsonOnServer("POST",serverRoot+"/mobigents-rest/objects/history","application/json",JSON.stringify(history),
    		function(data){
    		},
    		function(){
    		}
	);
}


</script>

</html>
